{"ast":null,"code":"var _jsxFileName = \"D:\\\\DKHP_demo\\\\dkhp_frontend\\\\src\\\\Page\\\\RegisteredCoursesPage.js\",\n  _s = $RefreshSig$();\nimport { useState, useEffect, useContext } from \"react\";\nimport { Alert, Button, Modal } from \"react-bootstrap\";\nimport { unenrollCourses } from \"../API/StudentAPI\";\nimport { getEnrolledCourses } from \"../API/CourseAPI\";\nimport CourseTable from \"../Component/CourseTable\";\nimport { ClientContext } from \"../Router/ClientRouter\";\nimport { RegisteredCourses_AlertModal, RegisteredCourses_ResultModal } from \"../Component/Modal\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst RegisteredCoursesPage = () => {\n  _s();\n  const {\n    courseData,\n    setError\n  } = useContext(ClientContext);\n  const [courseIds, setCourseIds] = useState(new Set());\n  const [regCourseIds, setRegCourseIds] = useState([]);\n  const [modal, setModal] = useState({\n    show: 0,\n    data: null\n  }); //0:ko show, 1:show alertModal, 2:show resultModal\n  const [isDelButtonDisabled, setIsDelButtonDisabled] = useState(true);\n  const sendRequest = () => {\n    unenrollCourses([...courseIds]).then(res => {\n      const result = new Map(Object.entries(res.data));\n      setRegCourseIds(prev => {\n        const updatedRegCourseIds = prev.filter(courseId => result.get(courseId) && result.get(courseId) == \"Unenroll successfully\");\n        return updatedRegCourseIds;\n      });\n      setModal({\n        show: 2,\n        data: regCourseIds\n      });\n    }).catch(err => setError(err));\n  };\n  const handleClose = () => {\n    setModal({\n      show: false,\n      data: []\n    });\n  };\n  useEffect(() => {\n    if (courseIds.size === 0) setIsDelButtonDisabled(true);else setIsDelButtonDisabled(false);\n  }, [courseIds]);\n  useEffect(() => {\n    getEnrolledCourses().then(res => {\n      setRegCourseIds(res.data);\n    }).catch(err => setError(err));\n  }, []);\n  const filterCourses = courseData.filter(course => regCourseIds.indexOf(course.id) > -1);\n  const regInfo = {\n    numberOfCourses: filterCourses.length,\n    creditNumber: 0\n  };\n  for (let course of filterCourses) regInfo.creditNumber += course.subject.theoryCreditNumber;\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"main-page\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ContentAlignment\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: [\"\\u0110\\xE3 \\u0111\\u0103ng k\\xED: \", regInfo.numberOfCourses, \" l\\u1EDBp(\", regInfo.creditNumber, \" t\\xEDn ch\\u1EC9)\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 44,\n          columnNumber: 41\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: \"btn btn-danger\",\n          onClick: () => setModal({\n            show: 1,\n            data: null\n          }),\n          disabled: isDelButtonDisabled,\n          children: \"H\\u1EE7y \\u0111\\u0103ng k\\xED\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 45,\n          columnNumber: 41\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 43,\n        columnNumber: 31\n      }, this), /*#__PURE__*/_jsxDEV(CourseTable, {\n        filterCourses: filterCourses,\n        courseIds: courseIds,\n        setCourseIds: setCourseIds\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 31\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 21\n    }, this), modal.show != 0 && (modal.show == 1 ? /*#__PURE__*/_jsxDEV(RegisteredCourses_AlertModal, {\n      modal: modal,\n      courseData: courseData,\n      courseIds: courseIds,\n      sendRequest: sendRequest,\n      handleClose: handleClose\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 42\n    }, this) : /*#__PURE__*/_jsxDEV(RegisteredCourses_ResultModal, {\n      modal: modal,\n      handleClose: handleClose\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 34\n    }, this))]\n  }, void 0, true);\n};\n_s(RegisteredCoursesPage, \"33lak47gUdAnvfpMLdqIPzMqKRc=\");\n_c = RegisteredCoursesPage;\nexport default RegisteredCoursesPage;\nvar _c;\n$RefreshReg$(_c, \"RegisteredCoursesPage\");","map":{"version":3,"names":["useState","useEffect","useContext","Alert","Button","Modal","unenrollCourses","getEnrolledCourses","CourseTable","ClientContext","RegisteredCourses_AlertModal","RegisteredCourses_ResultModal","jsxDEV","_jsxDEV","Fragment","_Fragment","RegisteredCoursesPage","_s","courseData","setError","courseIds","setCourseIds","Set","regCourseIds","setRegCourseIds","modal","setModal","show","data","isDelButtonDisabled","setIsDelButtonDisabled","sendRequest","then","res","result","Map","Object","entries","prev","updatedRegCourseIds","filter","courseId","get","catch","err","handleClose","size","filterCourses","course","indexOf","id","regInfo","numberOfCourses","length","creditNumber","subject","theoryCreditNumber","children","className","fileName","_jsxFileName","lineNumber","columnNumber","type","onClick","disabled","_c","$RefreshReg$"],"sources":["D:/DKHP_demo/dkhp_frontend/src/Page/RegisteredCoursesPage.js"],"sourcesContent":["import { useState, useEffect, useContext } from \"react\";\r\nimport { Alert, Button, Modal } from \"react-bootstrap\";\r\nimport { unenrollCourses } from \"../API/StudentAPI\";\r\nimport { getEnrolledCourses } from \"../API/CourseAPI\";\r\nimport CourseTable from \"../Component/CourseTable\";\r\nimport { ClientContext} from \"../Router/ClientRouter\";\r\nimport { RegisteredCourses_AlertModal, RegisteredCourses_ResultModal } from \"../Component/Modal\";\r\nconst RegisteredCoursesPage=()=>{\r\n          const {courseData, setError}=useContext(ClientContext);\r\n          const [courseIds, setCourseIds]=useState(new Set());\r\n          const [regCourseIds, setRegCourseIds]=useState([]);\r\n          const [modal, setModal]=useState({show:0, data:null});//0:ko show, 1:show alertModal, 2:show resultModal\r\n          const [isDelButtonDisabled, setIsDelButtonDisabled]=useState(true);\r\n          const sendRequest=()=>{\r\n                    unenrollCourses([...courseIds]).then(res=>{\r\n                              const result=new Map(Object.entries(res.data));\r\n                              setRegCourseIds(prev=>{\r\n                                    const updatedRegCourseIds=prev.filter(courseId=>result.get(courseId)&&result.get(courseId)==\"Unenroll successfully\");\r\n                                    return updatedRegCourseIds;\r\n                              })\r\n                              setModal({show:2, data:regCourseIds});\r\n                      })\r\n                      .catch(err=>setError(err))\r\n           }\r\n            const handleClose=()=>{\r\n                  setModal({show:false, data:[]});\r\n            }\r\n            useEffect(()=>{\r\n                        if(courseIds.size===0) setIsDelButtonDisabled(true);\r\n                        else setIsDelButtonDisabled(false);\r\n            },[courseIds])\r\n            useEffect(()=>{\r\n                        getEnrolledCourses().then(res=>{\r\n                              setRegCourseIds(res.data);\r\n                        }).catch(err=>setError(err))\r\n                  },[])\r\n                  const filterCourses=courseData.filter(course=>regCourseIds.indexOf(course.id)>-1);\r\n                  const regInfo={numberOfCourses:filterCourses.length,creditNumber:0};\r\n                  for(let course of filterCourses) regInfo.creditNumber+=course.subject.theoryCreditNumber;\r\n        return(\r\n          <>\r\n                    <div className=\"main-page\">\r\n                              <div className=\"ContentAlignment\">\r\n                                        <h4>Đã đăng kí: {regInfo.numberOfCourses} lớp({regInfo.creditNumber} tín chỉ)</h4>\r\n                                        <button type=\"button\" className=\"btn btn-danger\" onClick={()=>setModal({show:1,data:null})} disabled={isDelButtonDisabled}>Hủy đăng kí</button>\r\n                                        \r\n                              </div>\r\n                              <CourseTable filterCourses={filterCourses} courseIds={courseIds} setCourseIds={setCourseIds}/>\r\n                    </div>\r\n                    {modal.show!=0&&\r\n                          (modal.show==1?<RegisteredCourses_AlertModal modal={modal} courseData={courseData} courseIds={courseIds} sendRequest={sendRequest} handleClose={handleClose}/>\r\n                                :<RegisteredCourses_ResultModal modal={modal} handleClose={handleClose}/>)}\r\n          </>\r\n          );\r\n}\r\nexport default RegisteredCoursesPage;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}