{"ast":null,"code":"import _objectSpread from\"D:/DKHP_demo/dkhp_frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"D:/DKHP_demo/dkhp_frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{API_ENDPOINT}from\"../Util/Constraint\";import{useState}from\"react\";import{useSnackbar}from\"notistack\";import{Link,useNavigate}from\"react-router-dom\";import AxiosService from\"../Util/AxiosService\";import UitIcon from\"../Resourses/uit icon.png\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=function Login(){var navigate=useNavigate();var _useState=useState({username:'',password:''}),_useState2=_slicedToArray(_useState,2),form=_useState2[0],setForm=_useState2[1];var _useSnackbar=useSnackbar(),enqueueSnackbar=_useSnackbar.enqueueSnackbar;var _useState3=useState({txtUsername:false,txtPassword:false}),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var onSubmit=function onSubmit(){var validate=validateData(form);var config=null;var anchorOrigin={horizontal:'center',vertical:'bottom'};if(validate){var formData=new FormData();formData.append('username',form.username);formData.append('password',form.password);AxiosService.post(API_ENDPOINT+'/api/auth/login',formData).then(function(res){localStorage.setItem('Authorization',res.data.token);localStorage.setItem('Role',res.data.role);config={variant:'success',anchorOrigin:anchorOrigin};enqueueSnackbar('Đăng nhập thành công',config);var url=\"/\";if(res.data.role==\"ADMIN\")url=\"/admin/\";navigate(url);}).catch(function(error){config={variant:'error',anchorOrigin:anchorOrigin};var errors=error.response;if(errors==null)enqueueSnackbar('Unknown error',config);else if(errors.status==401){enqueueSnackbar('Tên tài khoản hoặc mật khẩu không chính xác',config);}else if(errors.status==400)enqueueSnackbar(errors.data,config);});}};var handleChangeValue=function handleChangeValue(e){var name=e.target.name;var value=e.target.value;if(name=='username'){setForm(_objectSpread(_objectSpread({},form),{},{username:value}));}if(name=='password'){setForm(_objectSpread(_objectSpread({},form),{},{password:value}));}};var validateData=function validateData(data){var isValid=true;var txtUsername,txtPassword;if(data.username.trim().length==0){txtUsername=true;isValid=false;}else{txtUsername=false;}if(data.password.trim().length==0){isValid=false;txtPassword=true;}else{txtPassword=false;}setError(_objectSpread(_objectSpread({},error),{},{txtUsername:txtUsername,txtPassword:txtPassword}));return isValid;};return/*#__PURE__*/_jsx(\"div\",{className:\"OuterForm  py-4 bg-body-tertiary\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"form-signin w-100 m-auto text-center align-items-center\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"mb-4\",src:UitIcon,alt:\"\",width:\"72\",height:\"57\"}),/*#__PURE__*/_jsx(\"h1\",{className:\"h3 mb-3 fw-normal\",children:\"Please sign in\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-floating\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",id:\"exampleInputUsername\",placeholder:\"Username\",name:\"username\",onChange:function onChange(e){return handleChangeValue(e);}}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"exampleInputUsername\",children:\"Nh\\u1EADp MSSV ho\\u1EB7c email\"})]}),/*#__PURE__*/_jsx(\"div\",{style:error.txtUsername?{display:''}:{display:'none'},className:\"error\",children:\"T\\xEAn t\\xE0i kho\\u1EA3n kh\\xF4ng \\u0111\\u01B0\\u1EE3c \\u0111\\u1EC3 tr\\u1ED1ng\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-floating\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-control\",id:\"exampleInputPassword1\",placeholder:\"Password\",name:\"password\",onChange:function onChange(e){return handleChangeValue(e);}}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"exampleInputPassword1\",children:\"Nh\\u1EADp m\\u1EADt kh\\u1EA9u\"})]}),/*#__PURE__*/_jsx(\"div\",{style:error.txtPassword?{display:''}:{display:'none'},className:\"error\",children:\"M\\u1EADt kh\\u1EA9u kh\\xF4ng \\u0111\\u01B0\\u1EE3c \\u0111\\u1EC3 tr\\u1ED1ng\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary w-100 py-2\",onClick:function onClick(){return onSubmit();},children:\"\\u0110\\u0103ng Nh\\u1EADp\"}),/*#__PURE__*/_jsx(Link,{to:\"#\",children:\"Forgot password or username\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 mb-3 text-body-secondary\",children:\"\\xA9 2023\\u20132050\"})]})});};export default Login;","map":{"version":3,"names":["API_ENDPOINT","useState","useSnackbar","Link","useNavigate","AxiosService","UitIcon","jsx","_jsx","jsxs","_jsxs","Login","navigate","_useState","username","password","_useState2","_slicedToArray","form","setForm","_useSnackbar","enqueueSnackbar","_useState3","txtUsername","txtPassword","_useState4","error","setError","onSubmit","validate","validateData","config","anchorOrigin","horizontal","vertical","formData","FormData","append","post","then","res","localStorage","setItem","data","token","role","variant","url","catch","errors","response","status","handleChangeValue","e","name","target","value","_objectSpread","isValid","trim","length","className","children","src","alt","width","height","type","id","placeholder","onChange","htmlFor","style","display","onClick","to"],"sources":["D:/DKHP_demo/dkhp_frontend/src/Page/Login.js"],"sourcesContent":["import { API_ENDPOINT } from \"../Util/Constraint\"\r\nimport { useState } from \"react\"\r\nimport { useSnackbar } from \"notistack\"\r\nimport { Link, useNavigate } from \"react-router-dom\"\r\nimport AxiosService from \"../Util/AxiosService\"\r\nimport UitIcon from \"../Resourses/uit icon.png\"\r\n\r\nconst Login=()=>{\r\n          const navigate = useNavigate();\r\n          const [form, setForm] = useState({\r\n                    username: '',\r\n                    password: ''\r\n                })\r\n          const { enqueueSnackbar } = useSnackbar();\r\n          const [error,setError]=useState({ txtUsername: false, txtPassword: false });\r\n          const onSubmit=()=>{\r\n                    let validate = validateData(form)\r\n                    let config = null;\r\n                    let anchorOrigin = { horizontal: 'center' , vertical: 'bottom'}\r\n                    if(validate){\r\n                        const formData=new FormData();\r\n                        formData.append('username', form.username)\r\n                        formData.append('password', form.password)\r\n                        AxiosService.post(API_ENDPOINT+'/api/auth/login',formData).then(res=>{\r\n                            localStorage.setItem('Authorization', res.data.token);\r\n                            localStorage.setItem('Role', res.data.role);\r\n                            config = {variant: 'success',anchorOrigin:anchorOrigin}\r\n                            enqueueSnackbar('Đăng nhập thành công', config);\r\n                            let url=\"/\";\r\n                            if(res.data.role==\"ADMIN\") url=\"/admin/\";\r\n                            navigate(url);\r\n                        })\r\n                        .catch((error)=>{\r\n                            config = {variant: 'error',anchorOrigin:anchorOrigin}\r\n                            let errors = error.response;\r\n                            if(errors==null) enqueueSnackbar('Unknown error', config);\r\n                            else if (errors.status == 401) {\r\n                                enqueueSnackbar('Tên tài khoản hoặc mật khẩu không chính xác', config);\r\n                            }\r\n                            else if(errors.status==400) enqueueSnackbar(errors.data, config);\r\n                        })\r\n                }\r\n          }\r\n          const handleChangeValue = (e) => {\r\n                    let name = e.target.name;\r\n                    let value = e.target.value;\r\n                    if (name == 'username') {\r\n                        setForm({ ...form, username: value })\r\n                    }\r\n                    if (name == 'password') {\r\n                        setForm({ ...form, password: value })\r\n                    }\r\n                }\r\n          const validateData = (data) => {\r\n                    let isValid = true;\r\n                    let txtUsername, txtPassword;\r\n                    if (data.username.trim().length == 0) {\r\n                        txtUsername = true;\r\n                        isValid = false;\r\n                    } else {\r\n                        txtUsername = false;\r\n                    }\r\n                    if (data.password.trim().length == 0) {\r\n                        isValid = false;\r\n                        txtPassword = true;\r\n                    } else {\r\n                        txtPassword = false;\r\n                    }\r\n                    setError({ ...error, txtUsername: txtUsername, txtPassword: txtPassword })\r\n                    return isValid;\r\n          }\r\n          return(\r\n            <div className=\"OuterForm  py-4 bg-body-tertiary\">\r\n                <div className=\"form-signin w-100 m-auto text-center align-items-center\">\r\n                        <img className=\"mb-4\" src={UitIcon} alt=\"\" width=\"72\" height=\"57\"/>\r\n                        <h1 className=\"h3 mb-3 fw-normal\">Please sign in</h1>\r\n                    <div className=\"form-floating\">\r\n                        <input type=\"text\" className=\"form-control\" id=\"exampleInputUsername\" placeholder=\"Username\" name=\"username\" onChange={(e)=>handleChangeValue(e)}/> \r\n                        <label htmlFor=\"exampleInputUsername\">Nhập MSSV hoặc email</label>\r\n                    </div>\r\n                        <div style={error.txtUsername ? { display: ''} : { display: 'none' }} className=\"error\">\r\n                                    Tên tài khoản không được để trống\r\n                                </div>\r\n                    <div className=\"form-floating\">\r\n                        <input type=\"password\" className=\"form-control\" id=\"exampleInputPassword1\" placeholder=\"Password\" name=\"password\" onChange={(e)=>handleChangeValue(e)}/> \r\n                        <label htmlFor=\"exampleInputPassword1\">Nhập mật khẩu</label>\r\n                    </div>\r\n                    <div style={error.txtPassword ? { display: ''} : { display: 'none' }} className=\"error\">\r\n                                Mật khẩu không được để trống\r\n                        </div>\r\n                    <button className=\"btn btn-primary w-100 py-2\" onClick={()=>onSubmit()}>Đăng Nhập</button>\r\n                    <Link to=\"#\">Forgot password or username</Link><br/>\r\n                    <p className=\"mt-2 mb-3 text-body-secondary\">&copy; 2023–2050</p>\r\n            </div>\r\n        </div>\r\n        )\r\n}\r\nexport default Login;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}