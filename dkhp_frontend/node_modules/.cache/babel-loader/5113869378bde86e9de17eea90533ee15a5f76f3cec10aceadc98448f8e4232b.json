{"ast":null,"code":"var _jsxFileName = \"D:\\\\DKHP_demo\\\\dkhp_frontend\\\\src\\\\Page\\\\RegisteredCoursesPage.js\",\n  _s = $RefreshSig$();\nimport { useState, useEffect, useContext } from \"react\";\nimport { Alert, Button, Modal } from \"react-bootstrap\";\nimport { unenrollCourses } from \"../API/StudentAPI\";\nimport { getEnrolledCourses } from \"../API/CourseAPI\";\nimport CourseTable from \"../Component/CourseTable\";\nimport { ClientContext } from \"../Router/ClientRouter\";\nimport { RegisteredCourses_AlertModal, RegisteredCourses_ResultModal } from \"../Component/Modal\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst RegisteredCoursesPage = () => {\n  _s();\n  const {\n    courseData,\n    setError\n  } = useContext(ClientContext);\n  const [checkedIds, setCheckedIds] = useState(new Set());\n  const [regIds, setRegIds] = useState([]);\n  const [modal, setModal] = useState({\n    show: 0,\n    data: null\n  }); //0:ko show, 1:show alertModal, 2:show resultModal\n  const [isDelButtonDisabled, setIsDelButtonDisabled] = useState(true);\n  const sendRequest = () => {\n    unenrollCourses([...checkedIds]).then(res => {\n      const result = new Map(Object.entries(res.data));\n      console.log(\"Result\", result);\n      setRegIds(prevIds => {\n        const updatedRegIds = courseData.map(c => {\n          var info = result.get(c.courseId);\n          if (info && info == \"Unenroll successfully\") return c.id;\n        });\n        console.log(\"Updated\", updatedRegIds);\n        return updatedRegIds;\n      });\n      setCheckedIds(new Set());\n      setModal({\n        show: 2,\n        data: result\n      });\n    }).catch(err => setError(err));\n  };\n  const handleClose = () => {\n    setModal({\n      show: false,\n      data: []\n    });\n  };\n  useEffect(() => {\n    if (checkedIds.size === 0) setIsDelButtonDisabled(true);else setIsDelButtonDisabled(false);\n  }, [checkedIds]);\n  useEffect(() => {\n    getEnrolledCourses().then(res => {\n      setRegIds(res.data);\n    }).catch(err => setError(err));\n  }, []);\n  const filterCourses = courseData.filter(course => regIds.indexOf(course.id) > -1);\n  const regInfo = {\n    numberOfCourses: filterCourses.length,\n    creditNumber: 0\n  };\n  for (let course of filterCourses) regInfo.creditNumber += course.subject.theoryCreditNumber;\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"main-page\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ContentAlignment\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: [\"\\u0110\\xE3 \\u0111\\u0103ng k\\xED: \", regInfo.numberOfCourses, \" l\\u1EDBp(\", regInfo.creditNumber, \" t\\xEDn ch\\u1EC9)\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 50,\n          columnNumber: 41\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: \"btn btn-danger\",\n          onClick: () => setModal({\n            show: 1,\n            data: null\n          }),\n          disabled: isDelButtonDisabled,\n          children: \"H\\u1EE7y \\u0111\\u0103ng k\\xED\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 51,\n          columnNumber: 41\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 31\n      }, this), /*#__PURE__*/_jsxDEV(CourseTable, {\n        filterCourses: filterCourses,\n        checkedIds: checkedIds,\n        setCheckedIds: setCheckedIds\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 31\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 21\n    }, this), modal.show != 0 && (modal.show == 1 ? /*#__PURE__*/_jsxDEV(RegisteredCourses_AlertModal, {\n      modal: modal,\n      courseData: courseData,\n      checkedIds: checkedIds,\n      sendRequest: sendRequest,\n      handleClose: handleClose\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 42\n    }, this) : /*#__PURE__*/_jsxDEV(RegisteredCourses_ResultModal, {\n      modal: modal,\n      handleClose: handleClose\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 34\n    }, this))]\n  }, void 0, true);\n};\n_s(RegisteredCoursesPage, \"OZmhqs188TIwX44FILD11LYph5s=\");\n_c = RegisteredCoursesPage;\nexport default RegisteredCoursesPage;\nvar _c;\n$RefreshReg$(_c, \"RegisteredCoursesPage\");","map":{"version":3,"names":["useState","useEffect","useContext","Alert","Button","Modal","unenrollCourses","getEnrolledCourses","CourseTable","ClientContext","RegisteredCourses_AlertModal","RegisteredCourses_ResultModal","jsxDEV","_jsxDEV","Fragment","_Fragment","RegisteredCoursesPage","_s","courseData","setError","checkedIds","setCheckedIds","Set","regIds","setRegIds","modal","setModal","show","data","isDelButtonDisabled","setIsDelButtonDisabled","sendRequest","then","res","result","Map","Object","entries","console","log","prevIds","updatedRegIds","map","c","info","get","courseId","id","catch","err","handleClose","size","filterCourses","filter","course","indexOf","regInfo","numberOfCourses","length","creditNumber","subject","theoryCreditNumber","children","className","fileName","_jsxFileName","lineNumber","columnNumber","type","onClick","disabled","_c","$RefreshReg$"],"sources":["D:/DKHP_demo/dkhp_frontend/src/Page/RegisteredCoursesPage.js"],"sourcesContent":["import { useState, useEffect, useContext } from \"react\";\r\nimport { Alert, Button, Modal } from \"react-bootstrap\";\r\nimport { unenrollCourses } from \"../API/StudentAPI\";\r\nimport { getEnrolledCourses } from \"../API/CourseAPI\";\r\nimport CourseTable from \"../Component/CourseTable\";\r\nimport { ClientContext} from \"../Router/ClientRouter\";\r\nimport { RegisteredCourses_AlertModal, RegisteredCourses_ResultModal } from \"../Component/Modal\";\r\nconst RegisteredCoursesPage=()=>{\r\n          const {courseData, setError}=useContext(ClientContext);\r\n          const [checkedIds, setCheckedIds]=useState(new Set());\r\n          const [regIds, setRegIds]=useState([]);\r\n          const [modal, setModal]=useState({show:0, data:null}); //0:ko show, 1:show alertModal, 2:show resultModal\r\n          const [isDelButtonDisabled, setIsDelButtonDisabled]=useState(true);\r\n          const sendRequest=()=>{\r\n                    unenrollCourses([...checkedIds]).then(res=>{\r\n                              const result=new Map(Object.entries(res.data));\r\n                              console.log(\"Result\",result);\r\n                              setRegIds(prevIds=>{\r\n                                    const updatedRegIds=courseData.map(c=>{\r\n                                          var info=result.get(c.courseId);\r\n                                         if(info&&info==\"Unenroll successfully\") return c.id;\r\n                                    })\r\n                                    console.log(\"Updated\",updatedRegIds);\r\n                                    return updatedRegIds;\r\n                              });\r\n                              setCheckedIds(new Set());\r\n                              setModal({show:2, data:result});\r\n                      })\r\n                      .catch(err=>setError(err))\r\n           }\r\n            const handleClose=()=>{\r\n                  setModal({show:false, data:[]});\r\n            }\r\n            useEffect(()=>{\r\n                        if(checkedIds.size===0) setIsDelButtonDisabled(true);\r\n                        else setIsDelButtonDisabled(false);\r\n            },[checkedIds])\r\n            useEffect(()=>{\r\n                        getEnrolledCourses().then(res=>{\r\n                              setRegIds(res.data);\r\n                        }).catch(err=>setError(err))\r\n                  },[])\r\n                  const filterCourses=courseData.filter(course=>regIds.indexOf(course.id)>-1);\r\n                  const regInfo={numberOfCourses:filterCourses.length,creditNumber:0};\r\n                  for(let course of filterCourses) regInfo.creditNumber+=course.subject.theoryCreditNumber;\r\n        return(\r\n          <>\r\n                    <div className=\"main-page\">\r\n                              <div className=\"ContentAlignment\">\r\n                                        <h4>Đã đăng kí: {regInfo.numberOfCourses} lớp({regInfo.creditNumber} tín chỉ)</h4>\r\n                                        <button type=\"button\" className=\"btn btn-danger\" onClick={()=>setModal({show:1,data:null})} disabled={isDelButtonDisabled}>Hủy đăng kí</button>\r\n                                        \r\n                              </div>\r\n                              <CourseTable filterCourses={filterCourses} checkedIds={checkedIds} setCheckedIds={setCheckedIds}/>\r\n                    </div>\r\n                    {modal.show!=0&&\r\n                          (modal.show==1?<RegisteredCourses_AlertModal modal={modal} courseData={courseData} checkedIds={checkedIds} sendRequest={sendRequest} handleClose={handleClose}/>\r\n                                :<RegisteredCourses_ResultModal modal={modal} handleClose={handleClose}/>)}\r\n          </>\r\n          );\r\n}\r\nexport default RegisteredCoursesPage;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}