{"ast":null,"code":"var _jsxFileName = \"D:\\\\DKHP_demo\\\\dkhp_frontend\\\\src\\\\Page\\\\RegisteredCoursesPage.js\",\n  _s = $RefreshSig$();\nimport { useState, useEffect, useContext } from \"react\";\nimport { Alert, Button, Modal } from \"react-bootstrap\";\nimport { unenrollCourses } from \"../API/StudentAPI\";\nimport { getEnrolledCourses } from \"../API/CourseAPI\";\nimport CourseTable from \"../Component/CourseTable\";\nimport { ClientContext } from \"../Router/ClientRouter\";\nimport { RegisteredCourses_AlertModal, RegisteredCourses_ResultModal } from \"../Component/Modal\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst RegisteredCoursesPage = () => {\n  _s();\n  const {\n    courseData,\n    setError\n  } = useContext(ClientContext);\n  const [checkedIds, setCheckedIds] = useState(new Set());\n  const [regIds, setRegIds] = useState(new Set());\n  const [modal, setModal] = useState({\n    show: 0,\n    data: null\n  }); //0:ko show, 1:show alertModal, 2:show resultModal\n  const [isDelButtonDisabled, setIsDelButtonDisabled] = useState(true);\n  const sendRequest = () => {\n    unenrollCourses([...checkedIds]).then(res => {\n      const result = new Map(Object.entries(res.data));\n      const deletedRegIds = new Set();\n      courseData.forEach(c => {\n        var info = result.get(c.courseId);\n        if (info == \"Unenroll successfully\") deletedRegIds.add(c.id);\n      });\n      setRegIds(prevIds => {\n        return prevIds.filter(id => !deletedRegIds.has(id));\n      });\n      setCheckedIds(new Set());\n      setModal({\n        show: 2,\n        data: result\n      });\n    }).catch(err => setError(err));\n  };\n  const handleClose = () => {\n    setModal({\n      show: false,\n      data: []\n    });\n  };\n  useEffect(() => {\n    if (checkedIds.size === 0) setIsDelButtonDisabled(true);else setIsDelButtonDisabled(false);\n  }, [checkedIds]);\n  useEffect(() => {\n    getEnrolledCourses().then(res => {\n      setRegIds(new Set(res.data));\n    }).catch(err => setError(err));\n  }, []);\n  const filterCourses = courseData.filter(course => regIds.has(course.id));\n  const regInfo = {\n    numberOfCourses: filterCourses.length,\n    creditNumber: 0\n  };\n  for (let course of filterCourses) regInfo.creditNumber += course.subject.theoryCreditNumber;\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"main-page\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ContentAlignment\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: [\"\\u0110\\xE3 \\u0111\\u0103ng k\\xED: \", regInfo.numberOfCourses, \" l\\u1EDBp(\", regInfo.creditNumber, \" t\\xEDn ch\\u1EC9)\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 49,\n          columnNumber: 41\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: \"btn btn-danger\",\n          onClick: () => setModal({\n            show: 1,\n            data: null\n          }),\n          disabled: isDelButtonDisabled,\n          children: \"H\\u1EE7y \\u0111\\u0103ng k\\xED\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 50,\n          columnNumber: 41\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 31\n      }, this), /*#__PURE__*/_jsxDEV(CourseTable, {\n        filterCourses: filterCourses,\n        checkedIds: checkedIds,\n        setCheckedIds: setCheckedIds\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 31\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 21\n    }, this), modal.show != 0 && (modal.show == 1 ? /*#__PURE__*/_jsxDEV(RegisteredCourses_AlertModal, {\n      modal: modal,\n      courseData: courseData,\n      checkedIds: checkedIds,\n      sendRequest: sendRequest,\n      handleClose: handleClose\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 42\n    }, this) : /*#__PURE__*/_jsxDEV(RegisteredCourses_ResultModal, {\n      modal: modal,\n      handleClose: handleClose\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 34\n    }, this))]\n  }, void 0, true);\n};\n_s(RegisteredCoursesPage, \"yol4aQbeaGRKCnZiAc4O59RxU2E=\");\n_c = RegisteredCoursesPage;\nexport default RegisteredCoursesPage;\nvar _c;\n$RefreshReg$(_c, \"RegisteredCoursesPage\");","map":{"version":3,"names":["useState","useEffect","useContext","Alert","Button","Modal","unenrollCourses","getEnrolledCourses","CourseTable","ClientContext","RegisteredCourses_AlertModal","RegisteredCourses_ResultModal","jsxDEV","_jsxDEV","Fragment","_Fragment","RegisteredCoursesPage","_s","courseData","setError","checkedIds","setCheckedIds","Set","regIds","setRegIds","modal","setModal","show","data","isDelButtonDisabled","setIsDelButtonDisabled","sendRequest","then","res","result","Map","Object","entries","deletedRegIds","forEach","c","info","get","courseId","add","id","prevIds","filter","has","catch","err","handleClose","size","filterCourses","course","regInfo","numberOfCourses","length","creditNumber","subject","theoryCreditNumber","children","className","fileName","_jsxFileName","lineNumber","columnNumber","type","onClick","disabled","_c","$RefreshReg$"],"sources":["D:/DKHP_demo/dkhp_frontend/src/Page/RegisteredCoursesPage.js"],"sourcesContent":["import { useState, useEffect, useContext } from \"react\";\r\nimport { Alert, Button, Modal } from \"react-bootstrap\";\r\nimport { unenrollCourses } from \"../API/StudentAPI\";\r\nimport { getEnrolledCourses } from \"../API/CourseAPI\";\r\nimport CourseTable from \"../Component/CourseTable\";\r\nimport { ClientContext} from \"../Router/ClientRouter\";\r\nimport { RegisteredCourses_AlertModal, RegisteredCourses_ResultModal } from \"../Component/Modal\";\r\nconst RegisteredCoursesPage=()=>{\r\n          const {courseData, setError}=useContext(ClientContext);\r\n          const [checkedIds, setCheckedIds]=useState(new Set());\r\n          const [regIds, setRegIds]=useState(new Set());\r\n          const [modal, setModal]=useState({show:0, data:null}); //0:ko show, 1:show alertModal, 2:show resultModal\r\n          const [isDelButtonDisabled, setIsDelButtonDisabled]=useState(true);\r\n          const sendRequest=()=>{\r\n                    unenrollCourses([...checkedIds]).then(res=>{\r\n                              const result=new Map(Object.entries(res.data));\r\n                              const deletedRegIds=new Set();\r\n                              courseData.forEach(c=>{\r\n                                    var info=result.get(c.courseId);\r\n                                   if(info==\"Unenroll successfully\") deletedRegIds.add(c.id);\r\n                              })\r\n                              setRegIds(prevIds=>{\r\n                                    return prevIds.filter(id=>!deletedRegIds.has(id));\r\n                              });\r\n                              setCheckedIds(new Set());\r\n                              setModal({show:2, data:result});\r\n                      })\r\n                      .catch(err=>setError(err))\r\n           }\r\n            const handleClose=()=>{\r\n                  setModal({show:false, data:[]});\r\n            }\r\n            useEffect(()=>{\r\n                        if(checkedIds.size===0) setIsDelButtonDisabled(true);\r\n                        else setIsDelButtonDisabled(false);\r\n            },[checkedIds])\r\n            useEffect(()=>{\r\n                        getEnrolledCourses().then(res=>{\r\n                              setRegIds(new Set(res.data));\r\n                        }).catch(err=>setError(err))\r\n                  },[])\r\n                  const filterCourses=courseData.filter(course=>regIds.has(course.id));\r\n                  const regInfo={numberOfCourses:filterCourses.length,creditNumber:0};\r\n                  for(let course of filterCourses) regInfo.creditNumber+=course.subject.theoryCreditNumber;\r\n        return(\r\n          <>\r\n                    <div className=\"main-page\">\r\n                              <div className=\"ContentAlignment\">\r\n                                        <h4>Đã đăng kí: {regInfo.numberOfCourses} lớp({regInfo.creditNumber} tín chỉ)</h4>\r\n                                        <button type=\"button\" className=\"btn btn-danger\" onClick={()=>setModal({show:1,data:null})} disabled={isDelButtonDisabled}>Hủy đăng kí</button>\r\n                                        \r\n                              </div>\r\n                              <CourseTable filterCourses={filterCourses} checkedIds={checkedIds} setCheckedIds={setCheckedIds}/>\r\n                    </div>\r\n                    {modal.show!=0&&\r\n                          (modal.show==1?<RegisteredCourses_AlertModal modal={modal} courseData={courseData} checkedIds={checkedIds} sendRequest={sendRequest} handleClose={handleClose}/>\r\n                                :<RegisteredCourses_ResultModal modal={modal} handleClose={handleClose}/>)}\r\n          </>\r\n          );\r\n}\r\nexport default RegisteredCoursesPage;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}