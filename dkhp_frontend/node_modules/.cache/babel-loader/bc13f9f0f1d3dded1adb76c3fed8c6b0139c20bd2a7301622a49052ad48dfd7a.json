{"ast":null,"code":"import _createForOfIteratorHelper from\"D:/DKHP_demo/dkhp_frontend/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _toConsumableArray from\"D:/DKHP_demo/dkhp_frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"D:/DKHP_demo/dkhp_frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect,useContext}from\"react\";import{Alert,Button,Modal}from\"react-bootstrap\";import{unenrollCourses}from\"../API/StudentAPI\";import{getEnrolledCourses}from\"../API/CourseAPI\";import CourseTable from\"../Component/CourseTable\";import{ClientContext}from\"../Router/ClientRouter\";import{RegisteredCourses_AlertModal,RegisteredCourses_ResultModal}from\"../Component/Modal\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var RegisteredCoursesPage=function RegisteredCoursesPage(){var _useContext=useContext(ClientContext),courseData=_useContext.courseData,setError=_useContext.setError;var _useState=useState(new Set()),_useState2=_slicedToArray(_useState,2),checkedIds=_useState2[0],setCheckedIds=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),regIds=_useState4[0],setRegIds=_useState4[1];var _useState5=useState({show:0,data:null}),_useState6=_slicedToArray(_useState5,2),modal=_useState6[0],setModal=_useState6[1];//0:ko show, 1:show alertModal, 2:show resultModal\nvar _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),isDelButtonDisabled=_useState8[0],setIsDelButtonDisabled=_useState8[1];var sendRequest=function sendRequest(){unenrollCourses(_toConsumableArray(checkedIds)).then(function(res){var result=new Map(Object.entries(res.data));var deletedRegIds=new Set();courseData.forEach(function(c){var info=result.get(c.courseId);if(info==\"Unenroll successfully\")deletedRegIds.add(c.id);});setRegIds(function(prevIds){return prevIds.filter(function(id){return!deletedRegIds.has(id);});});setCheckedIds(new Set());setModal({show:2,data:result});}).catch(function(err){return setError(err);});};var handleClose=function handleClose(){setModal({show:false,data:[]});};useEffect(function(){if(checkedIds.size===0)setIsDelButtonDisabled(true);else setIsDelButtonDisabled(false);},[checkedIds]);useEffect(function(){getEnrolledCourses().then(function(res){setRegIds(res.data);}).catch(function(err){return setError(err);});},[]);var filterCourses=courseData.filter(function(course){return regIds.indexOf(course.id)>-1;});var regInfo={numberOfCourses:filterCourses.length,creditNumber:0};var _iterator=_createForOfIteratorHelper(filterCourses),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var course=_step.value;regInfo.creditNumber+=course.subject.theoryCreditNumber;}}catch(err){_iterator.e(err);}finally{_iterator.f();}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"main-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"ContentAlignment\",children:[/*#__PURE__*/_jsxs(\"h4\",{children:[\"\\u0110\\xE3 \\u0111\\u0103ng k\\xED: \",regInfo.numberOfCourses,\" l\\u1EDBp(\",regInfo.creditNumber,\" t\\xEDn ch\\u1EC9)\"]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-danger\",onClick:function onClick(){return setModal({show:1,data:null});},disabled:isDelButtonDisabled,children:\"H\\u1EE7y \\u0111\\u0103ng k\\xED\"})]}),/*#__PURE__*/_jsx(CourseTable,{filterCourses:filterCourses,checkedIds:checkedIds,setCheckedIds:setCheckedIds})]}),modal.show!=0&&(modal.show==1?/*#__PURE__*/_jsx(RegisteredCourses_AlertModal,{modal:modal,courseData:courseData,checkedIds:checkedIds,sendRequest:sendRequest,handleClose:handleClose}):/*#__PURE__*/_jsx(RegisteredCourses_ResultModal,{modal:modal,handleClose:handleClose}))]});};export default RegisteredCoursesPage;","map":{"version":3,"names":["useState","useEffect","useContext","Alert","Button","Modal","unenrollCourses","getEnrolledCourses","CourseTable","ClientContext","RegisteredCourses_AlertModal","RegisteredCourses_ResultModal","jsxs","_jsxs","jsx","_jsx","Fragment","_Fragment","RegisteredCoursesPage","_useContext","courseData","setError","_useState","Set","_useState2","_slicedToArray","checkedIds","setCheckedIds","_useState3","_useState4","regIds","setRegIds","_useState5","show","data","_useState6","modal","setModal","_useState7","_useState8","isDelButtonDisabled","setIsDelButtonDisabled","sendRequest","_toConsumableArray","then","res","result","Map","Object","entries","deletedRegIds","forEach","c","info","get","courseId","add","id","prevIds","filter","has","catch","err","handleClose","size","filterCourses","course","indexOf","regInfo","numberOfCourses","length","creditNumber","_iterator","_createForOfIteratorHelper","_step","s","n","done","value","subject","theoryCreditNumber","e","f","children","className","type","onClick","disabled"],"sources":["D:/DKHP_demo/dkhp_frontend/src/Page/RegisteredCoursesPage.js"],"sourcesContent":["import { useState, useEffect, useContext } from \"react\";\r\nimport { Alert, Button, Modal } from \"react-bootstrap\";\r\nimport { unenrollCourses } from \"../API/StudentAPI\";\r\nimport { getEnrolledCourses } from \"../API/CourseAPI\";\r\nimport CourseTable from \"../Component/CourseTable\";\r\nimport { ClientContext} from \"../Router/ClientRouter\";\r\nimport { RegisteredCourses_AlertModal, RegisteredCourses_ResultModal } from \"../Component/Modal\";\r\nconst RegisteredCoursesPage=()=>{\r\n          const {courseData, setError}=useContext(ClientContext);\r\n          const [checkedIds, setCheckedIds]=useState(new Set());\r\n          const [regIds, setRegIds]=useState([]);\r\n          const [modal, setModal]=useState({show:0, data:null}); //0:ko show, 1:show alertModal, 2:show resultModal\r\n          const [isDelButtonDisabled, setIsDelButtonDisabled]=useState(true);\r\n          const sendRequest=()=>{\r\n                    unenrollCourses([...checkedIds]).then(res=>{\r\n                              const result=new Map(Object.entries(res.data));\r\n                              const deletedRegIds=new Set();\r\n                              courseData.forEach(c=>{\r\n                                    var info=result.get(c.courseId);\r\n                                   if(info==\"Unenroll successfully\") deletedRegIds.add(c.id);\r\n                              })\r\n                              setRegIds(prevIds=>{\r\n                                    return prevIds.filter(id=>!deletedRegIds.has(id));\r\n                              });\r\n                              setCheckedIds(new Set());\r\n                              setModal({show:2, data:result});\r\n                      })\r\n                      .catch(err=>setError(err))\r\n           }\r\n            const handleClose=()=>{\r\n                  setModal({show:false, data:[]});\r\n            }\r\n            useEffect(()=>{\r\n                        if(checkedIds.size===0) setIsDelButtonDisabled(true);\r\n                        else setIsDelButtonDisabled(false);\r\n            },[checkedIds])\r\n            useEffect(()=>{\r\n                        getEnrolledCourses().then(res=>{\r\n                              setRegIds(res.data);\r\n                        }).catch(err=>setError(err))\r\n                  },[])\r\n                  const filterCourses=courseData.filter(course=>regIds.indexOf(course.id)>-1);\r\n                  const regInfo={numberOfCourses:filterCourses.length,creditNumber:0};\r\n                  for(let course of filterCourses) regInfo.creditNumber+=course.subject.theoryCreditNumber;\r\n        return(\r\n          <>\r\n                    <div className=\"main-page\">\r\n                              <div className=\"ContentAlignment\">\r\n                                        <h4>Đã đăng kí: {regInfo.numberOfCourses} lớp({regInfo.creditNumber} tín chỉ)</h4>\r\n                                        <button type=\"button\" className=\"btn btn-danger\" onClick={()=>setModal({show:1,data:null})} disabled={isDelButtonDisabled}>Hủy đăng kí</button>\r\n                                        \r\n                              </div>\r\n                              <CourseTable filterCourses={filterCourses} checkedIds={checkedIds} setCheckedIds={setCheckedIds}/>\r\n                    </div>\r\n                    {modal.show!=0&&\r\n                          (modal.show==1?<RegisteredCourses_AlertModal modal={modal} courseData={courseData} checkedIds={checkedIds} sendRequest={sendRequest} handleClose={handleClose}/>\r\n                                :<RegisteredCourses_ResultModal modal={modal} handleClose={handleClose}/>)}\r\n          </>\r\n          );\r\n}\r\nexport default RegisteredCoursesPage;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}