{"ast":null,"code":"import _createForOfIteratorHelper from\"D:/DKHP_demo/dkhp_frontend/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _toConsumableArray from\"D:/DKHP_demo/dkhp_frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"D:/DKHP_demo/dkhp_frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect,useContext}from\"react\";import{Alert,Button,Modal}from\"react-bootstrap\";import{unenrollCourses}from\"../API/StudentAPI\";import{getEnrolledCourses}from\"../API/CourseAPI\";import CourseTable from\"../Component/CourseTable\";import{ClientContext}from\"../Router/ClientRouter\";import{RegisteredCourses_AlertModal,RegisteredCourses_ResultModal}from\"../Component/Modal\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var RegisteredCoursesPage=function RegisteredCoursesPage(){var _useContext=useContext(ClientContext),courseData=_useContext.courseData,setError=_useContext.setError;var _useState=useState(new Set()),_useState2=_slicedToArray(_useState,2),courseIds=_useState2[0],setCourseIds=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),regCourseIds=_useState4[0],setRegCourseIds=_useState4[1];var _useState5=useState({show:0,data:null}),_useState6=_slicedToArray(_useState5,2),modal=_useState6[0],setModal=_useState6[1];//0:ko show, 1:show alertModal, 2:show resultModal\nvar _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),isDelButtonDisabled=_useState8[0],setIsDelButtonDisabled=_useState8[1];var sendRequest=function sendRequest(){unenrollCourses(_toConsumableArray(courseIds)).then(function(res){var result=new Map(Object.entries(res.data));setRegCourseIds(function(prev){var updatedRegCourseIds=prev.filter(function(courseId){return result.get(courseId)&&result.get(courseId)==\"Unenroll successfully\";});return updatedRegCourseIds;});setModal({show:2,data:regCourseIds});}).catch(function(err){return setError(err);});};var handleClose=function handleClose(){setModal({show:false,data:[]});};useEffect(function(){if(courseIds.size===0)setIsDelButtonDisabled(true);else setIsDelButtonDisabled(false);},[courseIds]);useEffect(function(){getEnrolledCourses().then(function(res){setRegCourseIds(res.data);});},[]);var filterCourses=courseData.filter(function(course){return regCourseIds.indexOf(course.id)>-1;});var regInfo={numberOfCourses:filterCourses.length,creditNumber:0};var _iterator=_createForOfIteratorHelper(filterCourses),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var course=_step.value;regInfo.creditNumber+=course.subject.theoryCreditNumber;}}catch(err){_iterator.e(err);}finally{_iterator.f();}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"main-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"ContentAlignment\",children:[/*#__PURE__*/_jsxs(\"h4\",{children:[\"\\u0110\\xE3 \\u0111\\u0103ng k\\xED: \",regInfo.numberOfCourses,\" l\\u1EDBp(\",regInfo.creditNumber,\" t\\xEDn ch\\u1EC9)\"]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-danger\",onClick:function onClick(){return setModal({show:1,data:null});},disabled:isDelButtonDisabled,children:\"H\\u1EE7y \\u0111\\u0103ng k\\xED\"})]}),/*#__PURE__*/_jsx(CourseTable,{filterCourses:filterCourses,courseIds:courseIds,setCourseIds:setCourseIds})]}),modal.show!=0&&(modal.show==1?/*#__PURE__*/_jsx(RegisteredCourses_AlertModal,{modal:modal,courseData:courseData,courseIds:courseIds,sendRequest:sendRequest,handleClose:handleClose}):/*#__PURE__*/_jsx(RegisteredCourses_ResultModal,{modal:modal,handleClose:handleClose}))]});};export default RegisteredCoursesPage;","map":{"version":3,"names":["useState","useEffect","useContext","Alert","Button","Modal","unenrollCourses","getEnrolledCourses","CourseTable","ClientContext","RegisteredCourses_AlertModal","RegisteredCourses_ResultModal","jsxs","_jsxs","jsx","_jsx","Fragment","_Fragment","RegisteredCoursesPage","_useContext","courseData","setError","_useState","Set","_useState2","_slicedToArray","courseIds","setCourseIds","_useState3","_useState4","regCourseIds","setRegCourseIds","_useState5","show","data","_useState6","modal","setModal","_useState7","_useState8","isDelButtonDisabled","setIsDelButtonDisabled","sendRequest","_toConsumableArray","then","res","result","Map","Object","entries","prev","updatedRegCourseIds","filter","courseId","get","catch","err","handleClose","size","filterCourses","course","indexOf","id","regInfo","numberOfCourses","length","creditNumber","_iterator","_createForOfIteratorHelper","_step","s","n","done","value","subject","theoryCreditNumber","e","f","children","className","type","onClick","disabled"],"sources":["D:/DKHP_demo/dkhp_frontend/src/Page/RegisteredCoursesPage.js"],"sourcesContent":["import { useState, useEffect, useContext } from \"react\";\r\nimport { Alert, Button, Modal } from \"react-bootstrap\";\r\nimport { unenrollCourses } from \"../API/StudentAPI\";\r\nimport { getEnrolledCourses } from \"../API/CourseAPI\";\r\nimport CourseTable from \"../Component/CourseTable\";\r\nimport { ClientContext} from \"../Router/ClientRouter\";\r\nimport { RegisteredCourses_AlertModal, RegisteredCourses_ResultModal } from \"../Component/Modal\";\r\nconst RegisteredCoursesPage=()=>{\r\n          const {courseData, setError}=useContext(ClientContext);\r\n          const [courseIds, setCourseIds]=useState(new Set());\r\n          const [regCourseIds, setRegCourseIds]=useState([]);\r\n          const [modal, setModal]=useState({show:0, data:null});//0:ko show, 1:show alertModal, 2:show resultModal\r\n          const [isDelButtonDisabled, setIsDelButtonDisabled]=useState(true);\r\n          const sendRequest=()=>{\r\n                    unenrollCourses([...courseIds]).then(res=>{\r\n                              const result=new Map(Object.entries(res.data));\r\n                              setRegCourseIds(prev=>{\r\n                                    const updatedRegCourseIds=prev.filter(courseId=>result.get(courseId)&&result.get(courseId)==\"Unenroll successfully\");\r\n                                    return updatedRegCourseIds;\r\n                              })\r\n                              setModal({show:2, data:regCourseIds});\r\n                      })\r\n                      .catch(err=>setError(err))\r\n           }\r\n            const handleClose=()=>{\r\n                  setModal({show:false, data:[]});\r\n            }\r\n            useEffect(()=>{\r\n                        if(courseIds.size===0) setIsDelButtonDisabled(true);\r\n                        else setIsDelButtonDisabled(false);\r\n            },[courseIds])\r\n            useEffect(()=>{\r\n                        getEnrolledCourses().then(res=>{\r\n                              setRegCourseIds(res.data);\r\n                        })\r\n                  },[])\r\n                  const filterCourses=courseData.filter(course=>regCourseIds.indexOf(course.id)>-1);\r\n                  const regInfo={numberOfCourses:filterCourses.length,creditNumber:0};\r\n                  for(let course of filterCourses) regInfo.creditNumber+=course.subject.theoryCreditNumber;\r\n        return(\r\n          <>\r\n                    <div className=\"main-page\">\r\n                              <div className=\"ContentAlignment\">\r\n                                        <h4>Đã đăng kí: {regInfo.numberOfCourses} lớp({regInfo.creditNumber} tín chỉ)</h4>\r\n                                        <button type=\"button\" className=\"btn btn-danger\" onClick={()=>setModal({show:1,data:null})} disabled={isDelButtonDisabled}>Hủy đăng kí</button>\r\n                                        \r\n                              </div>\r\n                              <CourseTable filterCourses={filterCourses} courseIds={courseIds} setCourseIds={setCourseIds}/>\r\n                    </div>\r\n                    {modal.show!=0&&\r\n                          (modal.show==1?<RegisteredCourses_AlertModal modal={modal} courseData={courseData} courseIds={courseIds} sendRequest={sendRequest} handleClose={handleClose}/>\r\n                                :<RegisteredCourses_ResultModal modal={modal} handleClose={handleClose}/>)}\r\n          </>\r\n          );\r\n}\r\nexport default RegisteredCoursesPage;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}